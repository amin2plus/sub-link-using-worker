{
    "outbounds":[
        {
            "tag":"esme tag config1",
          	///body config1
        },
        {
            "tag":"esme tag config2",
           	 ///body config2
        },
        {
            "tag":"esme tag config3",
            	///body config3
        },
        {
            "tag":"esme tag config4"
		///body config4
        },
        {
            "type":"selector",
            "tag":"Proxy",
            "outbounds":[
                "Auto",
                "esme tag config1",
                "esme tag config2",
                "esme tag config3",
                "esme tag config4"
            ],
            "default":"Auto"
        },
        {
            "type":"urltest",
            "tag":"Auto",
            "outbounds":[
                "esme tag config1",
                "esme tag config2",
                "esme tag config3",
                "esme tag config4"
            ],
            "url":"http://cp.cloudflare.com/generate_204",
            "interval":"1m",
            "tolerance":200,
            "interrupt_exist_connections":true
        },
        {
            "tag":"direct",
            "type":"direct"
        }
    ],
    "route":{
        "rule_set":[
            {
                "tag":"geoip-ir",
                "type":"remote",
                "format":"binary",
                "download_detour":"direct",
                "update_interval":"7d",
                "url":"https://cdn.jsdelivr.net/gh/Chocolate4U/Iran-sing-box-rules@rule-set/geoip-ir.srs"
            },
            {
                "tag":"geosite-all",
                "type":"remote",
                "format":"binary",
                "download_detour":"direct",
                "update_interval":"7d",
                "url":"https://github.com/bootmortis/sing-geosite/releases/latest/download/geosite-all.srs"
            }
        ],
        "rules":[
            {
                "action":"sniff"
            },
            {
                "action":"route",
                "clash_mode":"Direct",
                "outbound":"direct"
            },
            {
                "action":"route",
                "clash_mode":"Global",
                "outbound":"Proxy"
            },
            {
                "action":"hijack-dns",
                "protocol":"dns"
            },
            {
                "action":"reject",
                "ip_cidr":[
                    "224.0.0.0/3",
                    "ff00::/8"
                ]
            },
            {
                "action":"reject",
                "protocol":"bittorrent"
            },
            {
                "action":"reject",
                "domain_suffix":[
                    "cdn.yektanet.com",
                    "native-scripts.yektanet.com"
                ]
            },
            {
                "action":"route",
                "ip_cidr":[
                    "127.0.0.0/8",
                    "192.0.0.0/24",
                    "192.168.0.0/16"
                ],
                "outbound":"direct"
            },
            {
                "action":"route",
                "domain_suffix":[
                    ".ir",
                    "whatsapp.com",
                    "whatsapp.net"
                ],
                "outbound":"direct"
            },
            {
                "action":"route",   //some iranian apps use this to detect vpn
                "domain":[
                    "www.cloudflare.com"
                ],
                "outbound":"direct"
            },
            {
                "action":"route",
                "rule_set":[
                    "geoip-ir",
                    "geosite-all"
                ],
                "outbound":"direct"
            },
            {
                "action":"route",
                "process_name":[
                    "nearby_share.exe",
                    "WhatsApp.exe"
                ],
                "outbound":"direct"
            },
            {
                "action":"route",
                "package_name":[
                    "com.google.android.gms.nearby",
                    "com.samsung.android.app.sharelive",
                    "com.whatsapp",
                    "com.whatsapp.w4b"
                ],
                "outbound":"direct"
            }
        ],
        "final":"Proxy",
        "auto_detect_interface":true
    },
    "dns":{
        "servers":[
            {
                "tag":"dns-remote",
                "address":"https://8.8.8.8/dns-query", //better to find a working DoH to avoide dns hijaking
                "detour":"Proxy", //use proxy server to resolve dns other wise delete this line and it will use dns-decoy to resolving the DoH itself
                "address_resolver":"dns-decoy"
            },
            {
                "tag":"dns-decoy",
                "address":"8.8.8.8"
            },
            {
                "tag":"dns-direct",
                "address":"8.8.4.4",
                "detour":"direct"
            },
            {
                "tag":"dns-local",
                "address":"8.8.4.4",
                "detour":"direct"
            },
            {
                "tag":"dns-block",
                "address":"rcode://success"
            },
            {
                "tag":"fake-ip",
                "address":"fakeip"
            }
        ],
        "rules":[
            {
                "action":"route",
                "clash_mode":"Global",
                "server":"dns-remote",
                "source_ip_cidr":[
                    "172.19.0.0/30"
                ]
            },
            {
                "action":"route",
                "server":"dns-remote",
                "source_ip_cidr":[
                    "172.19.0.0/30"
                ]
            },
            {
                "action":"route",
                "clash_mode":"Direct",
                "server":"dns-direct"
            },
            {
                "action":"route",
                "outbound":"direct",
                "server":"dns-direct"
            },
            {
                "action":"route",
                "outbound":"any",
                "server":"fake-ip",
                "disable_cache":true
            },
            {
                "action":"reject",
                "domain_suffix":[
                    "cdn.yektanet.com",
                    "native-scripts.yektanet.com"
                ]
            },
            {
                "action":"reject",
                "protocol":"bittorrent"
            },
            {
                "action":"route",  //some iranian apps use this to detect vpn
                "domain":[
                    "www.cloudflare.com"
                ],
                "server":"dns-direct"
            },
            {
                "action":"route",
                "rule_set":"geosite-all",
                "server":"dns-direct"
            },
            {
                "action":"route",
                "domain_suffix":[
                    ".ir",
                    "whatsapp.com",
                    "whatsapp.net"
                ],
                "server":"dns-direct"
            }
        ],
        "final":"dns-remote",
        "strategy":"prefer_ipv4",
        "fakeip":{
            "enabled":true,
            "inet4_range":"198.18.0.0/15"
        }
    },
    "inbounds":[
        {
            "type":"tun",
            "tag":"tun-in",
            "stack":"system", //[system] will use less battery, use [gvisor] for better internal security
            "interface_name":"singbox",
            "address":"172.19.0.1/30",
            "auto_route":true,
            "endpoint_independent_nat":true
        },
        {
            "listen":"127.0.0.1",
            "listen_port":2080,
            "type":"mixed",
            "tag":"mixed-in",
            "users":[]
        }
    ],
    "experimental":{
	    "clash_api":{
            "external_controller":"127.0.0.1:9090", //use the links below to access web panel on pc , otherwise remove this part
            "access_control_allow_origin":[
                "https://metacubex.github.io/metacubexd",
                "https://metacubexd.pages.dev",
                "https://board.zash.run.place"
            ],
            "access_control_allow_private_network":true
        }
    },
    "log":{
        "level":"warn",
        "timestamp":true
    }
